"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"function"==typeof define&&define.amd?define([],e("lousyLoad")):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e("lousyLoad"):t.lousyLoad=e("lousyLoad")}(window,function(t){var e={immediate:!0},n=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n};window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var n=0;n<this.length;n++)t.call(e,this[n],n,this)});var o=function(){function o(i,r){_classCallCheck(this,o),this.utils={debounce:function(t,e,n){var o=void 0;return function(){var i=this,r=arguments,a=n&&!o;clearTimeout(o),o=setTimeout(function(){o=null,n||t.apply(i,r)},e),a&&t.apply(i,r)}},wrapElement:function(t,e){e.length||(e=[e]);for(var n=e.length-1;n>=0;n--){var o=n>0?t.cloneNode(!0):t,i=e[n],r=i.parentNode,a=i.nextSibling;o.appendChild(i),a?r.insertBefore(o,a):r.appendChild(o)}}},this.element=i,this._defaults=e,this._name=t,this.options=n(e,r),this.options.immediate&&this.init()}return _createClass(o,[{key:"init",value:function(){var t=this.element.querySelectorAll("img");return t.forEach(this.prepareImage.bind(this)),t}},{key:"prepareImage",value:function(t){var e=Math.max(document.documentElement.clientHeight,window.innerHeight||0),n=function(t){var e=window.getComputedStyle(t).getPropertyValue("max-width"),n=t.getAttribute("width"),o=t.getAttribute("height"),i=n/o;return e&&(e.indexOf("%")>-1?e=t.parentElement.offsetWidth:e.indexOf("px")>-1&&(e=e.replace("px","")),Number(n)>Number(e)&&(n=e,o=e/i)),{width:n,height:o,maxWidth:e,aspectRatio:i}}(t),o=document.createElement("span");o.classList.add("ll-image_wrapper"),o.style.width=n.width+"px",o.style.height=n.height+"px",o.style.display="inline-block",t.classList.add("ll-image"),t.style.width=n.width+"px",t.style.height=n.height+"px",this.utils.wrapElement(o,t),t.onload=function(){t.parentElement.classList.add("is-loaded")};var i=this.tryLoadImage(t,document.documentElement.scrollTop+e-100),r=this.utils.debounce(function(){console.log("scroll"),this.tryLoadImage(t,document.documentElement.scrollTop+e-100)&&window.removeEventListener("scroll",r)}.bind(this));i||window.addEventListener("scroll",r,50)}},{key:"tryLoadImage",value:function(t,e){return t.offsetTop<e&&(t.src=t.getAttribute("data-src"),!0)}}]),o}();if(window.jQuery){var i=window.jQuery;i.fn[t]=function(e){return e=e||{},this.each(function(){i.data(this,"plugin_"+t)||(e.element=this,i.data(this,"plugin_"+t,new o(this,e)))})}}return o});