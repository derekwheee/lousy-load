"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"function"==typeof define&&define.amd?define([],e("lousyLoad")):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e("lousyLoad"):t.lousyLoad=e("lousyLoad")}(window,function(t){var e={immediate:!0,selector:"",threshold:100,wrapElement:!0},n=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n};window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var n=0;n<this.length;n++)t.call(e,this[n],n,this)});var i=function(){function i(o,r){_classCallCheck(this,i),this.utils={debounce:function(t,e,n){var i=void 0;return function(){var o=this,r=arguments,a=n&&!i;clearTimeout(i),i=setTimeout(function(){i=null,n||t.apply(o,r)},e),a&&t.apply(o,r)}},wrapElement:function(t,e){e.length||(e=[e]);for(var n=e.length-1;n>=0;n--){var i=n>0?t.cloneNode(!0):t,o=e[n],r=o.parentNode,a=o.nextSibling;i.appendChild(o),a?r.insertBefore(i,a):r.appendChild(i)}}},this.element=o,this._defaults=e,this._name=t,this.options=n(e,r),this.options.immediate&&this.init()}return _createClass(i,[{key:"init",value:function(){var t=this.element.querySelectorAll("img"+this.options.selector);return t.forEach(this.prepareImage.bind(this)),t}},{key:"prepareImage",value:function(t){var e=Math.max(document.documentElement.clientHeight,window.innerHeight||0),n=function(t){var e=window.getComputedStyle(t).getPropertyValue("max-width"),n=t.getAttribute("width"),i=t.getAttribute("height"),o=n/i;if(e){if(e.indexOf("%")>-1){var r=Number(e.replace("%",""))/100,a=window.getComputedStyle(t.parentElement).getPropertyValue("width");e=Number(a.replace("px",""))*r}else e.indexOf("px")>-1&&(e=e.replace("px",""));Number(n)>Number(e)&&(n=e,i=e/o)}return{width:n,height:i,maxWidth:e,aspectRatio:o}}(t),i=void 0;this.options.wrapElement&&((i=document.createElement("span")).classList.add("ll-image_wrapper"),i.style.width=n.width+"px",i.style.height=n.height+"px",i.style.display="inline-block",t.classList.add("ll-image"),t.style.width=n.width+"px",t.style.height=n.height+"px",this.utils.wrapElement(i,t)),t.onload=function(){t.parentElement.classList.add("is-loaded"),this.options.wrapElement&&i.classList.add("is-loaded")}.bind(this);var o=this.tryLoadImage(t,document.body.scrollTop+e-this.options.threshold),r=this.utils.debounce(function(){this.tryLoadImage(t,document.body.scrollTop+e-this.options.threshold)&&window.removeEventListener("scroll",r)}.bind(this),50);o||window.addEventListener("scroll",r)}},{key:"tryLoadImage",value:function(t,e){return t.offsetTop<e&&(t.src=t.getAttribute("data-src"),!0)}}]),i}();if(window.jQuery){var o=window.jQuery;o.fn[t]=function(e){return e=e||{},this.each(function(){o.data(this,"plugin_"+t)||(e.element=this,o.data(this,"plugin_"+t,new i(this,e)))})}}return i});